@page "/list-product"
@using StaffWebApp.Components.Pages
@using StaffWebApp.Components.Product.Update
@using StaffWebApp.Services.Product
@using StaffWebApp.Services.Product.Requests
@using StaffWebApp.Services.Product.Vms
@using WebAppIntegrated.Pagination

<MudContainer>
    <MudTable Items="_paginatedProduct.Data">
        <ToolBarContent>
            <MudText Typo="Typo.h6">Danh sách sản phẩm</MudText>
            <MudSpacer />
            <MudTextField @bind-Value="_request.SearchString"
                          Placeholder="Search"
                          Adornment="Adornment.Start"
                          AdornmentIcon="@Icons.Material.Filled.Search"
                          IconSize="Size.Medium"
                          Class="mt-0">
            </MudTextField>
            <MudButton OnClick="() => OnOpenCreateProductClick()"
                       Color="Color.Primary"
                       Variant="Variant.Outlined"
                       Class="ml-3">
                Thêm sản phẩm
            </MudButton>
        </ToolBarContent>
        <HeaderContent>
            <MudTh>Stt</MudTh>
            <MudTh>Tên</MudTh>
            <MudTh>Danh mục</MudTh>
            <MudTh>Tổng số lượng</MudTh>
            <MudTh>Hành động</MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd>@(_paginatedProduct.Data.ToList().IndexOf(context) + 1)</MudTd>
            <MudTd>@context.Name</MudTd>
            <MudTd>@string.Join(", ", context.Categories)</MudTd>
            <MudTd>@context.TotalStock</MudTd>
            <MudTd>
                <MudButton OnClick="async () => await ShowDetails(context.Id, context.Name)"
                           Color="Color.Secondary"
                           Variant="Variant.Outlined">
                    Chi tiết
                </MudButton>
                <MudButton OnClick="async () => await ShowUpdateProductInfoDialog(context.Id, context.Name)"
                           Color="Color.Secondary"
                           Variant="Variant.Outlined">
                    Sửa thông tin chung
                </MudButton>
            </MudTd>
        </RowTemplate>
        <PagerContent>
            <Pagination HasNext="_paginatedProduct.HasNext"
                        PageNumber="_paginatedProduct.PageNumber" />
        </PagerContent>
    </MudTable>
</MudContainer>
